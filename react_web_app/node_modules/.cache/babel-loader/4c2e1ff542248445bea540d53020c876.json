{"ast":null,"code":"'use strict';\n/* global wx */\n\nvar socketOpen = false;\nvar socketMsgQueue = [];\n\nfunction sendSocketMessage(msg) {\n  if (socketOpen) {\n    wx.sendSocketMessage({\n      data: msg.buffer || msg\n    });\n  } else {\n    socketMsgQueue.push(msg);\n  }\n}\n\nfunction WebSocket(url, protocols) {\n  var ws = {\n    OPEN: 1,\n    CLOSING: 2,\n    CLOSED: 3,\n    readyState: socketOpen ? 1 : 0,\n    send: sendSocketMessage,\n    close: wx.closeSocket,\n    onopen: null,\n    onmessage: null,\n    onclose: null,\n    onerror: null\n  };\n  wx.connectSocket({\n    url: url,\n    protocols: protocols\n  });\n  wx.onSocketOpen(function (res) {\n    ws.readyState = ws.OPEN;\n    socketOpen = true;\n\n    for (var i = 0; i < socketMsgQueue.length; i++) {\n      sendSocketMessage(socketMsgQueue[i]);\n    }\n\n    socketMsgQueue = [];\n    ws.onopen && ws.onopen.apply(ws, arguments);\n  });\n  wx.onSocketMessage(function (res) {\n    ws.onmessage && ws.onmessage.apply(ws, arguments);\n  });\n  wx.onSocketClose(function () {\n    ws.onclose && ws.onclose.apply(ws, arguments);\n    ws.readyState = ws.CLOSED;\n    socketOpen = false;\n  });\n  wx.onSocketError(function () {\n    ws.onerror && ws.onerror.apply(ws, arguments);\n    ws.readyState = ws.CLOSED;\n    socketOpen = false;\n  });\n  return ws;\n}\n\nvar websocket = require('websocket-stream');\n\nfunction buildUrl(opts, client) {\n  var protocol = opts.protocol === 'wxs' ? 'wss' : 'ws';\n  var url = protocol + '://' + opts.hostname + opts.path;\n\n  if (opts.port && opts.port !== 80 && opts.port !== 443) {\n    url = protocol + '://' + opts.hostname + ':' + opts.port + opts.path;\n  }\n\n  if (typeof opts.transformWsUrl === 'function') {\n    url = opts.transformWsUrl(url, opts, client);\n  }\n\n  return url;\n}\n\nfunction setDefaultOpts(opts) {\n  if (!opts.hostname) {\n    opts.hostname = 'localhost';\n  }\n\n  if (!opts.path) {\n    opts.path = '/';\n  }\n\n  if (!opts.wsOptions) {\n    opts.wsOptions = {};\n  }\n}\n\nfunction createWebSocket(client, opts) {\n  var websocketSubProtocol = opts.protocolId === 'MQIsdp' && opts.protocolVersion === 3 ? 'mqttv3.1' : 'mqtt';\n  setDefaultOpts(opts);\n  var url = buildUrl(opts, client);\n  return websocket(WebSocket(url, [websocketSubProtocol]));\n}\n\nfunction buildBuilder(client, opts) {\n  opts.hostname = opts.hostname || opts.host;\n\n  if (!opts.hostname) {\n    throw new Error('Could not determine host. Specify host manually.');\n  }\n\n  return createWebSocket(client, opts);\n}\n\nmodule.exports = buildBuilder;","map":{"version":3,"sources":["/Users/neythen/Desktop/Projects/LED_paint/react_web_app/node_modules/mqtt-react/node_modules/mqtt/lib/connect/wx.js"],"names":["socketOpen","socketMsgQueue","sendSocketMessage","msg","wx","data","buffer","push","WebSocket","url","protocols","ws","OPEN","CLOSING","CLOSED","readyState","send","close","closeSocket","onopen","onmessage","onclose","onerror","connectSocket","onSocketOpen","res","i","length","apply","arguments","onSocketMessage","onSocketClose","onSocketError","websocket","require","buildUrl","opts","client","protocol","hostname","path","port","transformWsUrl","setDefaultOpts","wsOptions","createWebSocket","websocketSubProtocol","protocolId","protocolVersion","buildBuilder","host","Error","module","exports"],"mappings":"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","sourcesContent":["'use strict'\n\n/* global wx */\nvar socketOpen = false\nvar socketMsgQueue = []\n\nfunction sendSocketMessage (msg) {\n  if (socketOpen) {\n    wx.sendSocketMessage({\n      data: msg.buffer || msg\n    })\n  } else {\n    socketMsgQueue.push(msg)\n  }\n}\n\nfunction WebSocket (url, protocols) {\n  var ws = {\n    OPEN: 1,\n    CLOSING: 2,\n    CLOSED: 3,\n    readyState: socketOpen ? 1 : 0,\n    send: sendSocketMessage,\n    close: wx.closeSocket,\n    onopen: null,\n    onmessage: null,\n    onclose: null,\n    onerror: null\n  }\n\n  wx.connectSocket({\n    url: url,\n    protocols: protocols\n  })\n  wx.onSocketOpen(function (res) {\n    ws.readyState = ws.OPEN\n    socketOpen = true\n    for (var i = 0; i < socketMsgQueue.length; i++) {\n      sendSocketMessage(socketMsgQueue[i])\n    }\n    socketMsgQueue = []\n\n    ws.onopen && ws.onopen.apply(ws, arguments)\n  })\n  wx.onSocketMessage(function (res) {\n    ws.onmessage && ws.onmessage.apply(ws, arguments)\n  })\n  wx.onSocketClose(function () {\n    ws.onclose && ws.onclose.apply(ws, arguments)\n    ws.readyState = ws.CLOSED\n    socketOpen = false\n  })\n  wx.onSocketError(function () {\n    ws.onerror && ws.onerror.apply(ws, arguments)\n    ws.readyState = ws.CLOSED\n    socketOpen = false\n  })\n\n  return ws\n}\n\nvar websocket = require('websocket-stream')\n\nfunction buildUrl (opts, client) {\n  var protocol = opts.protocol === 'wxs' ? 'wss' : 'ws'\n  var url = protocol + '://' + opts.hostname + opts.path\n  if (opts.port && opts.port !== 80 && opts.port !== 443) {\n    url = protocol + '://' + opts.hostname + ':' + opts.port + opts.path\n  }\n  if (typeof (opts.transformWsUrl) === 'function') {\n    url = opts.transformWsUrl(url, opts, client)\n  }\n  return url\n}\n\nfunction setDefaultOpts (opts) {\n  if (!opts.hostname) {\n    opts.hostname = 'localhost'\n  }\n  if (!opts.path) {\n    opts.path = '/'\n  }\n\n  if (!opts.wsOptions) {\n    opts.wsOptions = {}\n  }\n}\n\nfunction createWebSocket (client, opts) {\n  var websocketSubProtocol =\n    (opts.protocolId === 'MQIsdp') && (opts.protocolVersion === 3)\n      ? 'mqttv3.1'\n      : 'mqtt'\n\n  setDefaultOpts(opts)\n  var url = buildUrl(opts, client)\n  return websocket(WebSocket(url, [websocketSubProtocol]))\n}\n\nfunction buildBuilder (client, opts) {\n  opts.hostname = opts.hostname || opts.host\n\n  if (!opts.hostname) {\n    throw new Error('Could not determine host. Specify host manually.')\n  }\n\n  return createWebSocket(client, opts)\n}\n\nmodule.exports = buildBuilder\n"]},"metadata":{},"sourceType":"script"}